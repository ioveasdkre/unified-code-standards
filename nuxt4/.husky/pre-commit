#!/bin/sh
# This loads nvm.sh and sets the correct PATH before running hook

# ğŸ” è‡ªå‹•åµæ¸¬åŸ·è¡Œç’°å¢ƒ
if command -v bun &>/dev/null; then
  RUNNER="bun x"
elif command -v pnpm &>/dev/null; then
  RUNNER="pnpm dlx"
elif command -v yarn &>/dev/null; then
  RUNNER="yarn dlx"
else
  RUNNER="npx"
fi

echo "ğŸ” Running pre-commit checks using [$RUNNER]..."

# 1ï¸âƒ£ åŸ·è¡Œ pretty-quick
echo "ğŸ¨ Running pretty-quick..."
$RUNNER pretty-quick --staged
if [ $? -ne 0 ]; then
  echo "âŒ Pretty-quick check failed. Commit aborted."
  exit 1
fi

# 2ï¸âƒ£ åŸ·è¡Œ lint-staged
echo "ğŸ” Running lint-staged..."
$RUNNER lint-staged
if [ $? -ne 0 ]; then
  echo "âŒ Lint-staged check failed. Commit aborted."
  exit 1
fi

echo "âœ… All checks passed. Proceeding with commit."
